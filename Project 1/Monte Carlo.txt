Sub Button2_Click()Dim S0, rr, q, sigma, T, Kone, Ktwo, Kthree, KfourS0 = Cells(1, 2)rr = Cells(2, 2)q = Cells(3, 2)sigma = Cells(4, 2)T = Cells(5, 2)Kone = Cells(6, 2)Ktwo = Cells(7, 2)Kthree = Cells(8, 2)Kfour = Cells(9, 2)Dim repetiton(1 To 20)For j = 1 To 20    Dim ST(1 To 10000), payoff(1 To 10000), discountedPayoff(1 To 10000)    For i = 1 To 10000    ST(i) = Exp(WorksheetFunction.Ln(S0) + (rr - q - 0.5 * sigma * sigma) * T + sigma * Sqr(T) * WorksheetFunction.NormSInv(Rnd()))        If ST(i) <= Kone Then            payoff(i) = 0        ElseIf Kone < ST(i) And ST(i) <= Ktwo Then            payoff(i) = ST(i) - Kone        ElseIf Ktwo < ST(i) And ST(i) <= Kthree Then            payoff(i) = Ktwo - Kone        ElseIf Kthree < ST(i) And ST(i) <= Kfour Then            payoff(i) = ((Ktwo - Kone) / (Kthree - Kfour)) * (ST(i) - Kthree) + (Ktwo - Kone)        ElseIf Kfour < ST(i) Then            payoff(i) = 0        End If        discountedPayoff(i) = payoff(i) * Exp(-rr * T)    Next i    repetiton(j) = WorksheetFunction.Average(discountedPayoff())Next jDim finalmean, finalsdfinalmean = WorksheetFunction.Average(repetiton())finalsd = WorksheetFunction.StDev(repetiton())Cells(6, 6) = "Price"Cells(7, 6) = "Upper Bound"Cells(8, 6) = "Lower Bound"Cells(6, 7) = finalmeanCells(7, 7) = finalmean - 2 * finalsdCells(8, 7) = finalmean + 2 * finalsdEnd Sub