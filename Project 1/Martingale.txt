Sub Button1_Click()Dim S0, rr, q, sigma, T, Kone, Ktwo, Kthree, KfourS0 = Cells(1, 2)rr = Cells(2, 2)q = Cells(3, 2)sigma = Cells(4, 2)T = Cells(5, 2)Kone = Cells(6, 2)Ktwo = Cells(7, 2)Kthree = Cells(8, 2)Kfour = Cells(9, 2)Dim d1, d2, d3, d4, d5, d6, d7, d8d1 = (Log(S0 / Kone) + (rr - q + (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d2 = (Log(S0 / Ktwo) + (rr - q + (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d3 = (Log(S0 / Kone) + (rr - q - (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d4 = (Log(S0 / Ktwo) + (rr - q - (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d5 = (Log(S0 / Kthree) + (rr - q - (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d6 = (Log(S0 / Kthree) + (rr - q + (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d7 = (Log(S0 / Kfour) + (rr - q + (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))d8 = (Log(S0 / Kfour) + (rr - q - (sigma ^ (2)) / 2) * T) / (sigma * (T ^ (1 / 2)))Dim nd1, nd2, nd3, nd4, nd5, nd6, nd7, nd8nd1 = WorksheetFunction.NormSDist(d1)nd2 = WorksheetFunction.NormSDist(d2)nd3 = WorksheetFunction.NormSDist(d3)nd4 = WorksheetFunction.NormSDist(d4)nd5 = WorksheetFunction.NormSDist(d5)nd6 = WorksheetFunction.NormSDist(d6)nd7 = WorksheetFunction.NormSDist(d7)nd8 = WorksheetFunction.NormSDist(d8)Dim priceprice = Exp(-rr * T) * (S0 * Exp((rr - q) * T) * (nd1 - nd2) - Kone * (nd3 - nd4) + (Ktwo - Kone) * (nd4 - nd5) + (Ktwo - Kone) / (Kthree - Kfour) * S0 * Exp((rr - q) * T) * (nd6 - nd7) - ((Ktwo - Kone) / (Kthree - Kfour) * Kthree - Ktwo + Kone) * (nd5 - nd8))Cells(3, 6) = “Price”Cells(3, 7) = priceEnd Sub