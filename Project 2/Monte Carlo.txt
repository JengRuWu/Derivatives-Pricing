Sub Button2_Click()Dim S0, K, r, q, sigma, T, num, repS0 = Cells(1, 2)K = Cells(2, 2)r = Cells(3, 2)q = Cells(4, 2)sigma = Cells(5, 2)T = Cells(6, 2)num = Cells(7, 2)rep = Cells(8, 2)ReDim repetitionCall(1 To rep), repetitionPut(1 To rep)For j = 1 To rep    ReDim ST(1 To num), payoffCall(1 To num), payoffPut(1 To num)    For i = 1 To num    ST(i) = Exp(WorksheetFunction.Ln(S0) + (r - q - 0.5 * sigma * sigma) * T + sigma * Sqr(T) * WorksheetFunction.NormSInv(Rnd()))    If ST(i) > K Then        payoffCall(i) = (ST(i) - K) * Exp(-r * T)        payoffPut(i) = 0    Else        payoffCall(i) = 0        payoffPut(i) = (K - ST(i)) * Exp(-r * T)    End If    Next i    repetitionCall(j) = WorksheetFunction.Average(payoffCall())    repetitionPut(j) = WorksheetFunction.Average(payoffPut())Next jDim meanCall, meanPut, sdCall, sdPutmeanCall = WorksheetFunction.Average(repetitionCall())sdCall = WorksheetFunction.StDev(repetitionCall())meanPut = WorksheetFunction.Average(repetitionPut())sdPut = WorksheetFunction.StDev(repetitionPut())Cells(6, 6) = "Call__ß°"Cells(7, 6) = "Call____§U¨…"Cells(8, 6) = "Call____§W¨…"Cells(6, 7) = meanCallCells(7, 7) = meanCall - 2 * sdCallCells(8, 7) = meanCall + 2 * sdCallCells(9, 6) = "Put__ß°"Cells(10, 6) = "Put____§U¨…"Cells(11, 6) = "Put____§W¨…"Cells(9, 7) = meanPutCells(10, 7) = meanPut - 2 * sdPutCells(11, 7) = meanPut + 2 * sdPutEnd Sub